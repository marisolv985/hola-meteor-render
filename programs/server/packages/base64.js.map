{"version":3,"sources":["meteor://ðŸ’»app/packages/base64/base64.js"],"names":["BASE_64_CHARS","BASE_64_VALS","Object","create","getChar","val","charAt","getVal","ch","i","length","encode","array","str","newBinary","charCodeAt","Error","answer","a","b","c","d","push","join","len","Uint8Array","ArrayBuffer","ret","$Uint8ArrayPolyfill","decode","Math","floor","arr","one","two","three","j","v","Base64"],"mappings":"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","file":"/packages/base64.js","sourcesContent":["// Base 64 encoding\n\nconst BASE_64_CHARS = \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\";\n\nconst BASE_64_VALS = Object.create(null);\n\nconst getChar = val => BASE_64_CHARS.charAt(val);\nconst getVal = ch => ch === '=' ? -1 : BASE_64_VALS[ch];\n\nfor (let i = 0; i < BASE_64_CHARS.length; i++) {\n  BASE_64_VALS[getChar(i)] = i;\n};\n\nconst encode = array => {\n  if (typeof array === \"string\") {\n    const str = array;\n    array = newBinary(str.length);\n    for (let i = 0; i < str.length; i++) {\n      const ch = str.charCodeAt(i);\n      if (ch > 0xFF) {\n        throw new Error(\n          \"Not ascii. Base64.encode can only take ascii strings.\");\n      }\n\n      array[i] = ch;\n    }\n  }\n\n  const answer = [];\n  let a = null;\n  let b = null;\n  let c = null;\n  let d = null;\n\n  for (let i = 0; i < array.length; i++) {\n    switch (i % 3) {\n      case 0:\n        a = (array[i] >> 2) & 0x3F;\n        b = (array[i] & 0x03) << 4;\n        break;\n      case 1:\n        b = b | (array[i] >> 4) & 0xF;\n        c = (array[i] & 0xF) << 2;\n        break;\n      case 2:\n        c = c | (array[i] >> 6) & 0x03;\n        d = array[i] & 0x3F;\n        answer.push(getChar(a));\n        answer.push(getChar(b));\n        answer.push(getChar(c));\n        answer.push(getChar(d));\n        a = null;\n        b = null;\n        c = null;\n        d = null;\n        break;\n    }\n  }\n\n  if (a != null) {\n    answer.push(getChar(a));\n    answer.push(getChar(b));\n    if (c == null) {\n      answer.push('=');\n    } else {\n      answer.push(getChar(c));\n    }\n\n    if (d == null) {\n      answer.push('=');\n    }\n  }\n\n  return answer.join(\"\");\n};\n\n\n\n// XXX This is a weird place for this to live, but it's used both by\n// this package and 'ejson', and we can't put it in 'ejson' without\n// introducing a circular dependency. It should probably be in its own\n// package or as a helper in a package that both 'base64' and 'ejson'\n// use.\nconst newBinary = len => {\n  if (typeof Uint8Array === 'undefined' || typeof ArrayBuffer === 'undefined') {\n    const ret = [];\n    for (let i = 0; i < len; i++) {\n      ret.push(0);\n    }\n\n    ret.$Uint8ArrayPolyfill = true;\n    return ret;\n  }\n  return new Uint8Array(new ArrayBuffer(len));\n};\n\nconst decode = str => {\n  let len = Math.floor((str.length * 3) / 4);\n  if (str.charAt(str.length - 1) == '=') {\n    len--;\n    if (str.charAt(str.length - 2) == '=') {\n      len--;\n    }\n  }\n\n  const arr = newBinary(len);\n\n  let one = null;\n  let two = null;\n  let three = null;\n\n  let j = 0;\n\n  for (let i = 0; i < str.length; i++) {\n    const c = str.charAt(i);\n    const v = getVal(c);\n    switch (i % 4) {\n      case 0:\n        if (v < 0) {\n          throw new Error('invalid base64 string');\n        }\n\n        one = v << 2;\n        break;\n      case 1:\n        if (v < 0) {\n          throw new Error('invalid base64 string');\n        }\n\n        one = one | (v >> 4);\n        arr[j++] = one;\n        two = (v & 0x0F) << 4;\n        break;\n      case 2:\n        if (v >= 0) {\n          two = two | (v >> 2);\n          arr[j++] = two;\n          three = (v & 0x03) << 6;\n        }\n\n        break;\n      case 3:\n        if (v >= 0) {\n          arr[j++] = three | v;\n        }\n\n        break;\n    }\n  }\n\n  return arr;\n};\n\nexport const Base64 = { encode, decode, newBinary };\n"]}