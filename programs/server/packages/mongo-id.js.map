{"version":3,"sources":["meteor://ðŸ’»app/packages/mongo-id/id.js"],"names":["EJSON","MongoID","_looksLikeObjectID","str","length","test","ObjectID","equals","other","valueOf","toString","_str","clone","typeName","getTimestamp","Number","parseInt","substr","toJSONValue","toHexString","hexString","toLowerCase","Error","Random","addType","idStringify","id","firstChar","charAt","undefined","JSON","stringify","idParse","parse"],"mappings":";;;;;;;;;;;;;;;;;;;;;;AAAA,SAASA,KAAK,QAAQ,eAAe;AACE;AAEvC,MAAMC,UAAU,CAAC;AAEjBA,QAAQC,kBAAkB,GAAGC,OAAOA,IAAIC,MAAM,KAAK,MAAM,cAAcC,IAAI,CAACF;AAE5EF,QAAQK,QAAQ,GAAG,MAAMA;IAevBC,OAAOC,KAAK,EAAE;QACZ,OAAOA,iBAAiBP,QAAQK,QAAQ,IACxC,IAAI,CAACG,OAAO,OAAOD,MAAMC,OAAO;IAClC;IAEAC,WAAW;QACT,OAAO,CAAC,UAAU,EAAE,IAAI,CAACC,IAAI,CAAC,EAAE,CAAC;IACnC;IAEAC,QAAQ;QACN,OAAO,IAAIX,QAAQK,QAAQ,CAAC,IAAI,CAACK,IAAI;IACvC;IAEAE,WAAW;QACT,OAAO;IACT;IAEAC,eAAe;QACb,OAAOC,OAAOC,QAAQ,CAAC,IAAI,CAACL,IAAI,CAACM,MAAM,CAAC,GAAG,IAAI;IACjD;IAEAR,UAAU;QACR,OAAO,IAAI,CAACE,IAAI;IAClB;IAEAO,cAAc;QACZ,OAAO,IAAI,CAACT,OAAO;IACrB;IAEAU,cAAc;QACZ,OAAO,IAAI,CAACV,OAAO;IACrB;IA7CA,YAAaW,SAAS,CAAE;QACtB,qCAAqC;QACrC,IAAIA,WAAW;YACbA,YAAYA,UAAUC,WAAW;YACjC,IAAI,CAACpB,QAAQC,kBAAkB,CAACkB,YAAY;gBAC1C,MAAM,IAAIE,MAAM;YAClB;YACA,sEAAsE;YACtE,IAAI,CAACX,IAAI,GAAGS;QACd,OAAO;YACL,IAAI,CAACT,IAAI,GAAGY,OAAOH,SAAS,CAAC;QAC/B;IACF;AAmCF;AAEApB,MAAMwB,OAAO,CAAC,OAAOrB,OAAO,IAAIF,QAAQK,QAAQ,CAACH;AAEjDF,QAAQwB,WAAW,GAAG,CAACC;IACrB,IAAIA,cAAczB,QAAQK,QAAQ,EAAE;QAClC,OAAOoB,GAAGjB,OAAO;IACnB,OAAO,IAAI,OAAOiB,OAAO,UAAU;QACjC,IAAIC,YAAYD,GAAGE,MAAM,CAAC;QAC1B,IAAIF,OAAO,IAAI;YACb,OAAOA;QACT,OAAO,IAAIC,cAAc,OAAO,mCAAmC;QACxDA,cAAc,OAAO,sCAAsC;QAC3D1B,QAAQC,kBAAkB,CAACwB,OAAO,gCAAgC;QAClEC,cAAc,KAAK;YAC5B,OAAO,CAAC,CAAC,EAAED,IAAI;QACjB,OAAO;YACL,OAAOA,IAAI,sCAAsC;QACnD;IACF,OAAO,IAAIA,OAAOG,WAAW;QAC3B,OAAO;IACT,OAAO,IAAI,OAAOH,OAAO,YAAYA,OAAO,MAAM;QAChD,MAAM,IAAIJ,MAAM;IAClB,OAAO;QACL,OAAO,CAAC,CAAC,EAAEQ,KAAKC,SAAS,CAACL,KAAK;IACjC;AACF;AAEAzB,QAAQ+B,OAAO,GAAG,CAACN;IACjB,IAAIC,YAAYD,GAAGE,MAAM,CAAC;IAC1B,IAAIF,OAAO,IAAI;QACb,OAAOA;IACT,OAAO,IAAIA,OAAO,KAAK;QACrB,OAAOG;IACT,OAAO,IAAIF,cAAc,KAAK;QAC5B,OAAOD,GAAGT,MAAM,CAAC;IACnB,OAAO,IAAIU,cAAc,KAAK;QAC5B,OAAOG,KAAKG,KAAK,CAACP,GAAGT,MAAM,CAAC;IAC9B,OAAO,IAAIhB,QAAQC,kBAAkB,CAACwB,KAAK;QACzC,OAAO,IAAIzB,QAAQK,QAAQ,CAACoB;IAC9B,OAAO;QACL,OAAOA;IACT;AACF;AAEmB","file":"/packages/mongo-id.js","sourcesContent":["import { EJSON } from 'meteor/ejson';\nimport { Random } from 'meteor/random';\n\nconst MongoID = {};\n\nMongoID._looksLikeObjectID = str => str.length === 24 && /^[0-9a-f]*$/.test(str);\n\nMongoID.ObjectID = class ObjectID {\n  constructor (hexString) {\n    //random-based impl of Mongo ObjectID\n    if (hexString) {\n      hexString = hexString.toLowerCase();\n      if (!MongoID._looksLikeObjectID(hexString)) {\n        throw new Error('Invalid hexadecimal string for creating an ObjectID');\n      }\n      // meant to work with _.isEqual(), which relies on structural equality\n      this._str = hexString;\n    } else {\n      this._str = Random.hexString(24);\n    }\n  }\n\n  equals(other) {\n    return other instanceof MongoID.ObjectID &&\n    this.valueOf() === other.valueOf();\n  }\n\n  toString() {\n    return `ObjectID(\"${this._str}\")`;\n  }\n\n  clone() {\n    return new MongoID.ObjectID(this._str);\n  }\n\n  typeName() {\n    return 'oid';\n  }\n\n  getTimestamp() {\n    return Number.parseInt(this._str.substr(0, 8), 16);\n  }\n\n  valueOf() {\n    return this._str;\n  }\n\n  toJSONValue() {\n    return this.valueOf();\n  }\n\n  toHexString() {\n    return this.valueOf();\n  }\n\n}\n\nEJSON.addType('oid', str => new MongoID.ObjectID(str));\n\nMongoID.idStringify = (id) => {\n  if (id instanceof MongoID.ObjectID) {\n    return id.valueOf();\n  } else if (typeof id === 'string') {\n    var firstChar = id.charAt(0);\n    if (id === '') {\n      return id;\n    } else if (firstChar === '-' || // escape previously dashed strings\n               firstChar === '~' || // escape escaped numbers, true, false\n               MongoID._looksLikeObjectID(id) || // escape object-id-form strings\n               firstChar === '{') { // escape object-form strings, for maybe implementing later\n      return `-${id}`;\n    } else {\n      return id; // other strings go through unchanged.\n    }\n  } else if (id === undefined) {\n    return '-';\n  } else if (typeof id === 'object' && id !== null) {\n    throw new Error('Meteor does not currently support objects other than ObjectID as ids');\n  } else { // Numbers, true, false, null\n    return `~${JSON.stringify(id)}`;\n  }\n};\n\nMongoID.idParse = (id) => {\n  var firstChar = id.charAt(0);\n  if (id === '') {\n    return id;\n  } else if (id === '-') {\n    return undefined;\n  } else if (firstChar === '-') {\n    return id.substr(1);\n  } else if (firstChar === '~') {\n    return JSON.parse(id.substr(1));\n  } else if (MongoID._looksLikeObjectID(id)) {\n    return new MongoID.ObjectID(id);\n  } else {\n    return id;\n  }\n};\n\nexport { MongoID };\n"]}